var status = -1;
    

// 건들이시면 안됩니다.
lineUseArray = [];
Howmany = 5; //

coincode = 4310198;
coinqty = 30;

앙 = null;


function start() {
    status = -1;
    action (1, 0, null);
}

function action(mode, type, selection) {
    ItemArray = [1050121, 1050122, 1050124, 1050129, 1050140, 1050143, 1050145, 1050157, 1050158, 1050159, 1050160, 1050170, 1050171, 1050179, 1050220, 1050221, 1050241, 1050256, 1050314, 1050315, 1050360, 1050366, 1050387, 1050401, 1050418, 1050419, 1051129, 1051130, 1051138, 1051145, 1051146, 1051148, 1051161, 1051169, 1051174, 1051185, 1051195, 1051196, 1051197, 1051198, 1051206, 1051208, 1051211, 1051212, 1051221, 1051231, 1051270, 1051271, 1051290, 1051312, 1051332, 1051333, 1051385, 1051386, 1051425, 1051430, 1051436, 1051457, 1051470, 1051487, 1051488, 1052054, 1052060, 1052061, 1052062, 1052063, 1052064, 1052065, 1052066, 1052069, 1052070, 1052073, 1052079, 1052082, 1052085, 1052086, 1052089, 1052135, 1052136, 1052147, 1052170, 1052174, 1052192, 1052198, 1052199, 1052204, 1052205, 1052206, 1052207, 1052210, 1052211, 1052212, 1052213, 1052214, 1052218, 1052225, 1052229, 1052232, 1052233, 1052246, 1052268, 1052283, 1052286, 1052292, 1052293, 1052294, 1052296, 1052298, 1052306, 1052324, 1052329, 1052330, 1052331, 1052338, 1052339, 1052340, 1052349, 1052367, 1052368, 1052369, 1052370, 1052372, 1052373, 1052408, 1052410, 1052411, 1052418, 1052419, 1052421, 1052423, 1052425, 1052426, 1052435, 1052439, 1052440, 1052442, 1052443, 1052445, 1052446, 1052447, 1052448, 1052449, 1052455, 1052458, 1052459, 1052474, 1052503, 1052531, 1052550, 1052551, 1052552, 1052554, 1052571, 1052574, 1052575, 1052594, 1052597, 1052602, 1052604, 1052610, 1052634, 1052643, 1052644, 1052654, 1052656, 1052657, 1052660, 1052662, 1052663, 1052668, 1052675, 1052676, 1052677, 1052678, 1052679, 1052680, 1052681, 1052682, 1052684, 1052685, 1052724, 1052725, 1052726, 1052727, 1052728, 1052746, 1052747, 1052749, 1052750, 1052771, 1052773, 1052774, 1052779, 1052780, 1052781, 1052782, 1052811, 1052812, 1052837, 1052838, 1052842, 1052843, 1052844, 1052870, 1052871, 1052872, 1052873, 1052874, 1052876, 1052891, 1052894, 1052895, 1052899, 1052901, 1052902, 1052903, 1052904, 1052910, 1052911, 1052916, 1052917, 1052920, 1052921, 1052922, 1052924, 1052925, 1052926, 1052946, 1052947, 1052949, 1052951, 1052955, 1052956, 1052957, 1052958, 1052959, 1052960, 1052961, 1052965, 1052966, 1052967, 1052999, 1053000, 1053001, 1053014, 1053016, 1053017, 1053022, 1053023, 1053024, 1053025, 1053031, 1053032, 1053041, 1053042, 1053045, 1053046, 1053047, 1053048, 1053051, 1053052, 1053053, 1053056, 1053057, 1053058, 1053059, 1053060, 1053061, 1053083, 1053084, 1053085, 1053086, 1053087, 1053088, 1053089, 1053090, 1053091, 1053092, 1053093, 1053094, 1053095, 1053099, 1053103, 1053104, 1053105, 1053106, 1053107, 1053109, 1053110, 1053115, 1053116, 1053117, 1053118, 1053119, 1053124, 1053125, 1053126, 1053127, 1053130, 1053131, 1053132, 1053133, 1053134, 1053138, 1053142, 1053144, 1053145, 1053146, 1053148, 1053155, 1053156, 1053157, 1053162, 1053163, 1053164, 1053168, 1053169, 1053170, 1053171, 1053172, 1053173, 1053174, 1053175, 1053176, 1053177, 1053180, 1053183, 1053184, 1053195, 1053196, 1053197, 1053198, 1053199, 1053200, 1053201, 1053202, 1053207, 1053208, 1053209, 1053210, 1053217, 1053218, 1053219, 1053220, 1053221, 1053222]
    if (mode == -1) {
        cm.dispose();
        return;
    }
    if (mode == 0) {
        status --;
    }
    if (mode == 1) {
        status++;
      if (status == 0) {
        앙 = selection;
        if (앙 != null) {
           for (i=0; i<ItemArray.length; i++) {
            말+= "#L"+i+"# #i"+ItemArray[i]+"#"
            if (lineUseArray.some(function(ok,index,lineUseArray) {
                 return ok == 앙;
                  }) == false) { 
           lineUseArray.push(앙);
            }
          }
        }
      }
    }    
    if (status == 0) {
       if (lineUseArray.length != Howmany) {
        말 = "#fn나눔고딕 Extrabold# 골라요! 골라! #b떡국코인30개#k로 자신이 #b원하는 아이템#k만 넣어 그 중 #b한가지#k를 얻을 수 있는 절호의 기회! 이 #b멋진 기회#k를 놓치진 않겠죠?\r\n\r\n"
        말+= "#r선택한 아이템 개수#k : "+lineUseArray.length+"\r\n"
        말+= "#r남은 선택 회수#k : "+(Howmany-lineUseArray.length)+"\r\n";
        for (i=0; i<ItemArray.length; i++) {
            말+= "#L"+i+"# #i"+ItemArray[i]+"#"
            if (lineUseArray.some(function(ok,index,lineUseArray) {
                 return ok == i;
                  }) == true) { 
                말+="#b#e#z"+ItemArray[i]+"##n#k\r\n"
            } else {
                말+="#z"+ItemArray[i]+"#\r\n";
            }
        }
        cm.sendSimple(말);
        status --;
       } else {
          말 = "현재 선택된 리스트의 아이템을 넣고 뽑기를 시작하시겠습니까?\r\n\r\n"
          for (i=0; i<lineUseArray.length; i++) {
             말+= "#i"+ItemArray[lineUseArray[i]]+"# #b#e#z"+ItemArray[lineUseArray[i]]+"##k#n\r\n";
          }
          cm.sendYesNo(말)
       }
      } else if (status == 1) {
         if (cm.itemQuantity(coincode) >= coinqty) {
          랜덤 = ItemArray[lineUseArray[Math.floor(Math.random() * lineUseArray.length)]]
          cm.gainItem(랜덤,1);
          cm.gainItem(coincode,-coinqty)
          cm.sendOk("어머어머! 좋은 아이템도 나오셨네요!\r\n\r\n#i"+랜덤+"# #b#z"+랜덤+"##k");
        } else {
          cm.sendOk("코인이 부족합니다.")
        }
          cm.dispose();
    }
}
